<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulasi Pembentukan Imej oleh Kanta</title>

<style>
body{
  font-family: Arial;
  max-width: 420px;
  margin: auto;
}

h2{
  text-align:center;
}

svg{
  border:1px solid black;
  width:100%;
  height:auto;
  touch-action:none;
}

button{
  width:100%;
  padding:10px;
  margin:4px 0;
  font-size:14px;
}

.info{
  margin-top:6px;
  font-size:14px;
  font-weight:bold;
}

.lens{ cursor:grab; }
.ray{ stroke:black; stroke-width:2; }
.virtual{ stroke-dasharray:5; }
</style>
</head>

<body>

<h2>Simulasi Pembentukan Imej oleh Kanta Cembung</h2>

<!-- Butang keadaan objek -->
<button onclick="setObj('far')">1️⃣ Objek jauh dari 2F</button>
<button onclick="setObj('2f')">2️⃣ Objek pada 2F</button>
<button onclick="setObj('between')">3️⃣ Objek antara F dan 2F</button>
<button onclick="setObj('inside')">4️⃣ Objek antara F dan pusat optik</button>

<svg id="svg" viewBox="0 0 900 300">

  <!-- Paksi utama -->
  <line x1="0" y1="150" x2="900" y2="150" stroke="black"/>

  <!-- Objek -->
  <line id="object" x1="200" y1="150" x2="200" y2="80"
        stroke="black" stroke-width="4"/>
  <text x="180" y="170">Objek</text>

  <!-- Kanta -->
  <ellipse id="lens" class="lens"
           cx="500" cy="150" rx="15" ry="80"
           fill="rgba(0,0,255,0.3)"/>

  <!-- Fokus -->
  <circle id="fL" r="4"/>
  <circle id="fR" r="4"/>
  <text id="fLt">F</text>
  <text id="fRt">F</text>

  <!-- Sinar -->
  <line id="ray1" class="ray"/>
  <line id="ray2" class="ray"/>
  <line id="rayVirtual" class="ray virtual"/>

</svg>

<div class="info" id="values"></div>
<div class="info" id="description"></div>

<script>
const svg = document.getElementById("svg");
const lens = document.getElementById("lens");
const object = document.getElementById("object");

let f = 100;          // fokus (cm = px)
let objH = 70;
let objX = 200;
let dragging = false;

lens.addEventListener("pointerdown",()=>dragging=true);
svg.addEventListener("pointerup",()=>dragging=false);

svg.addEventListener("pointermove",e=>{
  if(!dragging) return;
  let rect = svg.getBoundingClientRect();
  let x = (e.clientX - rect.left) * (900 / rect.width);
  if(x<300 || x>700) return;
  lens.setAttribute("cx",x);
  update(x);
});

function setObj(type){
  let lensX = lens.cx.baseVal.value;
  if(type==="far") objX = lensX - 3*f;
  if(type==="2f") objX = lensX - 2*f;
  if(type==="between") objX = lensX - 1.5*f;
  if(type==="inside") objX = lensX - 0.5*f;

  object.setAttribute("x1",objX);
  object.setAttribute("x2",objX);
  update(lensX);
}

function update(lensX){
  let u = lensX - objX;
  let v = (u*f)/(u-f);
  let m = v/u;

  let imgX = lensX + v;
  let imgH = objH * m;

  // Fokus
  fL.setAttribute("cx",lensX-f);
  fL.setAttribute("cy",150);
  fR.setAttribute("cx",lensX+f);
  fR.setAttribute("cy",150);
  fLt.setAttribute("x",lensX-f-5);
  fLt.setAttribute("y",170);
  fRt.setAttribute("x",lensX+f-5);
  fRt.setAttribute("y",170);

  // Sinar
  ray1.setAttribute("x1",objX);
  ray1.setAttribute("y1",150-objH);
  ray1.setAttribute("x2",imgX);
  ray1.setAttribute("y2",150+imgH);

  ray2.setAttribute("x1",objX);
  ray2.setAttribute("y1",150-objH);
  ray2.setAttribute("x2",imgX);
  ray2.setAttribute("y2",150+imgH);

  rayVirtual.setAttribute("x1",lensX);
  rayVirtual.setAttribute("y1",150-objH);
  rayVirtual.setAttribute("x2",imgX);
  rayVirtual.setAttribute("y2",150+imgH);

  // Papar nilai
  values.innerHTML =
    `u = ${u.toFixed(1)} cm | v = ${v.toFixed(1)} cm | f = ${f} cm`;

  // Teks automatik
  let jenis = v>0 ? "Nyata" : "Maya";
  let orientasi = m<0 ? "Songsang" : "Tegak";
  let saiz = Math.abs(m)>1 ? "Dibesarkan" : "Dikecilkan";

  description.innerHTML =
    `Imej adalah <b>${jenis}</b>, <b>${orientasi}</b> dan <b>${saiz}</b>.`;
}

update(500);
</script>

</body>
</html>
